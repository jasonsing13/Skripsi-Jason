<!DOCTYPE html>
<html lang="en">
<head>
    <title>Registration</title>
    <%- include('partials/head.ejs') %>
    <style>
        body {
            padding-top: 20px;
            padding-bottom: 40px;
        }
        .header {
            margin-bottom: 30px;
            text-align: center;
        }
        .form-section {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <a type="button" class="btn btn-outline-secondary float-start" href="/login"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 1024 1024"><path fill="currentColor" d="M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"/><path fill="currentColor" d="m237.248 512l265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"/></svg></a>
        <div class="header">
            <h1>MPM</h1>
            <h2>Registrasi Vendor</h2>
        </div>

        <div class="row">
            <div class="col-12">
                <ul data-tabs class="d-flex justify-content-center">
                    <li>
                        <a data-tabby-default href="#informasi">Informasi Vendor</a>
                    </li>
                    <li>
                        <a href="#bank">Akun Bank</a>
                    </li>
                    <li>
                        <a href="#perpajakan">Perpajakan</a>
                    </li>
                    <li>
                        <a href="#legalitas">Legalitas</a>
                    </li>
                </ul>
                <form action="/registration" method="POST">
                    <div id="informasi">
                        <div class="form-section">
                            <h3>Informasi Perusahaan</h3>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="nama_vendor">Nama Perusahaan</label>
                                    <input type="text" class="form-control" id="nama_vendor" name="nama_vendor" >
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="email_perusahaan">Email Perusahaan</label>
                                    <input type="email" class="form-control" id="email_perusahaan" name="email_perusahaan" >
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="username">Username</label>
                                    <input type="text" class="form-control" id="username" name="username" >
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="password">Password</label>
                                    <input type="password" class="form-control" id="password" name="password" >
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="jenis_vendor" class="form-label">Jenis Vendor</label>
                                <select class="form-select" id="jenis_vendor" name="jenis_vendor_id" >
                                    <option selected>Choose...</option>
                                    <% option_Jenis_Vendor.forEach(option => { %>
                                        <option value="<%= option.jenis_vendor_id %>"><%= option.nama_jenis_vendor %></option>
                                    <% }); %>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="kategori_vendor" class="form-label">Kategori Vendor</label>
                                <select class="form-select" id="kategori_vendor" name="kategori_vendor_id" >
                                    <option selected>Choose...</option>
                                    <% option_kategori_vendor.forEach(option => { %>
                                        <option value="<%= option.kategori_vendor_id %>"><%= option.nama_kategori_vendor %></option>
                                    <% }); %>
                                </select>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="status_kantor" class="form-label">Status Kantor</label>
                                    <select class="form-select" id="status_kantor" name="status_kantor">
                                        <option selected>Pilih Status Kantor</option>
                                        <option value="Pusat">Pusat</option>
                                        <option value="Cabang">Cabang</option>
                                        <option value="Perorangan">Perorangan</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="alamat_perusahaan">Alamat Perusahaan</label>
                                    <input type="text" class="form-control" id="alamat_perusahaan" name="alamat_perusahaan" >
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="nama_direktur">Nama Direktur/Pemilik</label>
                                    <input type="text" class="form-control" id="nama_direktur" name="nama_direktur" >
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="no_telp">Nomor Telepon Perusahaan</label>
                                    <input type="tel" class="form-control" id="no_telp" name="no_telp" >
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="negara">Negara</label>
                            <select class="form-select" id="negara" name="negara">
                                <option selected>Pilih Negara</option>
                                <option value="Indonesia">Indonesia</option>
                                <option value="Luar Negeri">Luar Negeri</option>
                            </select>
                        </div>
            
                        <div class="col-md-6 mb-3">
                            <label for="provinsi" class="form-label">Provinsi</label>
                            <select class="form-select" id="provinsi" name="provinsi_id" >
                                <option selected>Choose...</option>
                                <% option_Provinsi.forEach(option => { %>
                                    <option value="<%= option.provinsi_id %>"><%= option.nama_provinsi %></option>
                                <% }); %>
                            </select>
                        </div>
            
                        <div class="col-md-6 mb-3">
                            <label for="kabupaten_kota" class="form-label">Kabupaten/Kota</label>
                            <select class="form-select" id="kabupaten_kota" name="kk_id" >
                                <option selected>Choose...</option>
                            </select>
                        </div>
                        
                        <!-- <button type="button" class="btn btn-primary float-start" onclick="nextTab('informasi')">Back</button> -->
                        <button type="button" class="btn btn-primary float-end" onclick="nextTab('bank')">Selanjutnya</button>
                    </div>
                    <div id="bank">
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <h4>Akun Bank</h4>
                                <!-- KONEK KE TABLE REKENING -->
                                <div class="form-group">
                                    <label for="noRekening">Nomor Rekening</label>
                                    <input id="noRekening" class="form-control" type="text" name="no_rekening">
                                </div>
                                <div class="form-group">
                                    <label for="namaRekening">Nama Pemilik Rekening</label>
                                    <input id="namaRekening" class="form-control" type="text" name="nama_pemilik_rekening">
                                </div>

                                <!-- REKENING KE BANK -->
                                <div class="form-group">
                                    <label for="namaBank">Nama Bank</label>
                                    <select class="form-control" name="nama_bank" id="nama_bank">
                                        <% option_bank.forEach(option => { %>
                                            <option value="<%= option.bank_id %>"><%= option.nama_bank %></option>
                                        <% }); %>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary float-start" onclick="nextTab('informasi')">Back</button>
                        <button type="button" class="btn btn-primary float-end" onclick="nextTab('perpajakan')">Selanjutnya</button>
                    </div>
                    <div id="perpajakan">
                        <div class="col-md-6">
                            <h4>Informasi Perpajakan</h4>
                            <div class="form-group">
                                <label for="noNPWP">Nomor NPWP</label>
                                <input id="noNPWP" class="form-control" type="text" name="no_npwp">
                            </div>
                            <div class="form-group">
                                <label for="statusPKP">Status PKP</label>
                                <select class="form-control" name="status_pkp" id="statusPKP" onchange="cekpkp(value)">
                                    <option value="1">Sudah</option>
                                    <option value="0">Belum</option>
                                </select>
                            </div>
                            <div id="cekpkp" class="form-group">
                                <label for="nppkp">NPPKP</label>
                                <input id="nppkp" class="form-control" type="text" name="nppkp">
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary float-start" onclick="nextTab('bank')">Back</button>
                        <button type="button" class="btn btn-primary float-end" onclick="nextTab('legalitas')">Selanjutnya</button>
                    </div>
                    <div id="legalitas">
                        <div class="col-md-6">
                            <h4>Informasi Legalitas</h4>
                            <div class="form-group">
                                <label for="nibrba">Nomor NIB RBA</label>
                                <input id="nibrba" class="form-control" type="text" name="no_nibrba">
                            </div>
                            <div class="form-group">
                                <label for="ktpD">Nomor KTP Direktur/Pemilik</label>
                                <input id="ktpD" class="form-control" type="text" name="no_ktp_direktur">
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary float-start" onclick="nextTab('perpajakan')">Back</button>
                        <button type="submit" class="btn btn-primary float-end">Finish</button>
                    </div>
                </form>
            </div>
        </div>

            
    </div>
</body>
<script>
    document.getElementById('provinsi').addEventListener('change', async function() {
        const provinsi_id = this.value;
        const kabupatenKotaSelect = document.getElementById('kabupaten_kota');

        // Hapus semua opsi saat ini
        kabupatenKotaSelect.innerHTML = '<option selected>Choose...</option>';

        if (provinsi_id) {
            try {
                const response = await fetch(`/kabupaten-kota?provinsi_id=${provinsi_id}`);
                const options = await response.json();

                options.forEach(option => {
                    const opt = document.createElement('option');
                    opt.value = option.kk_id;
                    opt.textContent = option.nama_kk;
                    kabupatenKotaSelect.appendChild(opt);
                });
            } catch (error) {
                console.error('Error fetching kabupaten/kota:', error);
            }
        }
    });

    function cekpkp(val){
        pkp = $('#cekpkp')
        if(val == 0){
            console.log("cok")
            pkp.addClass('d-none', true);

        }else{
            pkp.removeClass('d-none');
        }
    }
</script>
<%- include('partials/footer.ejs') %>

<script>
    var tabs = new Tabby('[data-tabs]');
    document.addEventListener('tabby', function (event) {
        var tab = event.target;
        var content = event.detail.content;

    }, true);

    function nextTab(id){
        tabs.toggle('#'+id);
    }
</script>
</html>